{"version":3,"file":"lob.js","sources":["..//home/peter/Workshop14/lob/client/store.ts","..//home/peter/Workshop14/lob/client/app.js","..//home/peter/Workshop14/lob/client/client.js"],"sourcesContent":["\n// Abstract store\nfunction AStore(){\n  var state = {};\n  return {\n    advance: function(evolver){\n      console.log(\"advance\");\n      state = evolver(state);\n    },\n    getState: function(){\n      return state;\n    }\n  };\n};\nvar m: number;\nvar o: any;\no = Object;\nfunction newReading(state){\n  console.log(state);\n  var i = state.i || 0;\n  return o.assign({}, state, {i: i+1});\n};\n\nfunction startStreaming(state){\n  if (state.isTransmitting) { return state; }\n  return o.assign({}, state, {isTransmitting: true});\n}\n\nfunction MyStore(){\n  var myStore = this;\n  this.newReading = function(){\n    myStore.advance(newReading);\n  };\n  this.startStreaming = function(){\n    myStore.advance(startStreaming);\n  };\n}\n\n\nvar a = AStore();\nMyStore.prototype = a;\n\nexport default function(){\n  return new MyStore();\n}\n","import Store from \"./store.ts\";\n\nexport default function App(actions){\n  var services = {};\n  var components = {};\n  var store = Store();\n  // actions.newReading.register(store.newReading);\n  // actions.startStreaming.register(store.startStreaming);\n\n  return {\n    registerService: function(name, factory){\n      services[name] ={factory: factory};\n    },\n    getService: function(name){\n      var service = services[name];\n      if (service.instance) { return service.instance; }\n      return service.instance = service.factory(this);\n    },\n    registerComponent: function(name, factory){\n      components[name] ={factory: factory};\n    },\n    // name optional get from element data attribute\n    getComponent: function(element, name){\n      var component = components[name];\n      return component.factory(element, this);\n    },\n    actions: actions,\n    store: store\n  };\n}\n","/* jshint esnext: true */\nconsole.log(\"starting Client\");\n\nimport App from \"./app\";\n\nvar MyApp = App();\nMyApp.registerComponent(\"avionics\", function(element, enviroment){\n  // could pass on reading / on error into start\n  enviroment.getService(\"accelerometer\").start();\n  console.log(\"mounting avionics component\");\n});\n\nvar avionics = MyApp.getComponent(\"avionics\");\n"],"names":["Store"],"mappings":";;IACA;IACA;QACE,IAAI,KAAK,GAAG,EAAE;QACd,OAAO;YACL,OAAO,EAAE,UAAS,OAAO;gBACvB,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC;gBACtB,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;aACvB;YACD,QAAQ,EAAE;gBACR,OAAO,KAAK;;SAEf;;IACF;IAED,IAAI,CAAM;IACV,CAAC,GAAG,MAAM;IACV,oBAAoB,KAAK;QACvB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC;QAClB,IAAI,CAAC,GAAG,KAAK,CAAC,CAAC,IAAI,CAAC;QACpB,OAAO,CAAC,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,EAAE,EAAC,CAAC,EAAE,CAAC,GAAC,CAAC,EAAC,CAAC;;IACrC;IAED,wBAAwB,KAAK;QAC3B,IAAI,KAAK,CAAC,cAAc,EAAE;YAAE,OAAO,KAAK;;QACxC,OAAO,CAAC,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,EAAE,EAAC,cAAc,EAAE,IAAI,EAAC,CAAC;;IAGpD;QACE,IAAI,OAAO,GAAG,IAAI;QAClB,IAAI,CAAC,UAAU,GAAG;YAChB,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC;SAC5B;QACD,IAAI,CAAC,cAAc,GAAG;YACpB,OAAO,CAAC,OAAO,CAAC,cAAc,CAAC;SAChC;;IAIH,IAAI,CAAC,GAAG,MAAM,EAAE;IAChB,OAAO,CAAC,SAAS,GAAG,CAAC;;QAGnB,OAAO,IAAI,OAAO,EAAE;;;iBCzCM,OAAO;QACjC,IAAI,QAAQ,GAAG,EAAE;QACjB,IAAI,UAAU,GAAG,EAAE;QACnB,IAAI,KAAK,GAAG,SAAK,EAAE;;;QAInB,OAAO;YACL,eAAe,EAAE,UAAS,IAAI,EAAE,OAAO;gBACrC,QAAQ,CAAC,IAAI,CAAC,GAAE,EAAC,OAAO,EAAE,OAAO,EAAC;aACnC;YACD,UAAU,EAAE,UAAS,IAAI;gBACvB,IAAI,OAAO,GAAG,QAAQ,CAAC,IAAI,CAAC;gBAC5B,IAAI,OAAO,CAAC,QAAQ,EAAE;oBAAE,OAAO,OAAO,CAAC,QAAQ;;gBAC/C,OAAO,OAAO,CAAC,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC;aAChD;YACD,iBAAiB,EAAE,UAAS,IAAI,EAAE,OAAO;gBACvC,UAAU,CAAC,IAAI,CAAC,GAAE,EAAC,OAAO,EAAE,OAAO,EAAC;aACrC;;YAED,YAAY,EAAE,UAAS,OAAO,EAAE,IAAI;gBAClC,IAAI,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC;gBAChC,OAAO,SAAS,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC;aACxC;YACD,OAAO,EAAE,OAAO;YAChB,KAAK,EAAE;SACR;;;IC5BH;IACA,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC;IAI9B,IAAI,KAAK,GAAG,GAAG,EAAE;IACjB,KAAK,CAAC,iBAAiB,CAAC,UAAU,EAAE,UAAS,OAAO,EAAE,UAAU;;QAE9D,UAAU,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC,KAAK,EAAE;QAC9C,OAAO,CAAC,GAAG,CAAC,6BAA6B,CAAC;KAC3C,CAAC;IAEF,IAAI,QAAQ,GAAG,KAAK,CAAC,YAAY,CAAC,UAAU,CAAC;;"}