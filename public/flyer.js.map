{"version":3,"file":"flyer.js","sources":["..//Users/mattheworiordan/Projects/Ably/demos/lob/client/router.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/config.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/lib/device.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/flyer/uplink.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/node_modules/carbide/key-error.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/node_modules/carbide/struct.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/flyer/state.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/flyer/projection.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/lib/reading.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/lib/Audio.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/flyer.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/flyer/view/presenter.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/alert/display.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/flyer/view/display.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/lib/phone.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/lib/guage.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/utils/fn.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/flyer/view.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/utils/polyfill.js","..//Users/mattheworiordan/Projects/Ably/demos/lob/client/flyer.boot.js"],"sourcesContent":["/* jshint esnext: true */\n\n// Router makes use of current location\n// Router should always return some value of state it does not have the knowledge to regard it as invalid\n// Router is currently untested\n// Router does not follow modifications to the application location.\n// Router is generic for tracker and flyer at the moment\n// location is a size cause and might make sense to be lazily applied\nexport default function Router(location) {\n  if ( !(this instanceof Router) ) { return new Router(location); }\n  var router = this;\n  router.location = location;\n\n  function getState(){\n    return {\n      channelName: $(\"head\").data('channel-name')\n    };\n  }\n\n  Object.defineProperty(router, 'state', {\n    get: getState\n  });\n}\n","export var Config = {\n  readingPublishLimit: 200, // ms\n  flightPublishLimit: 1000, // ms\n  trackingGraphTimePeriod: 8000, // ms - time to keep points in visible graph\n  gravityMagnitudeConstant: 10, // default gravity magnitude value from accelerometer\n  broadcastNewChannelName: 'broadcast:channel' /* replicated in app.rb */\n};\n","export default function Device() {\n  if ( !(this instanceof Device) ) { return new Device(); }\n\n  var mobileDetect = new MobileDetect(window.navigator.userAgent);\n  var browser = platform;\n\n  function mobileDescription() {\n    if (mobileDetect.phone() && (mobileDetect.phone() !== 'UnknownPhone')) {\n      return mobileDetect.phone()\n    } else if (mobileDetect.tablet() && (mobileDetect.tablet() !== 'UnknownTablet')) {\n      return mobileDetect.tablet();\n    } else {\n      return platform.os.family;\n    }\n  }\n\n  function desktopDescription() {\n    return browser.os.family.replace(/Windows.*/,\"Windows\") + \" desktop\";\n  }\n\n  this.deviceDescription = function() {\n    if (mobileDetect.mobile()) {\n      return mobileDescription();\n    } else {\n      return desktopDescription();\n    }\n  }\n}\n","import { Config } from '../config';\nimport Device from \"../lib/device\";\n\nexport default function FlyerUplink(options, logger) {\n  if ( !(this instanceof FlyerUplink) ) { return new FlyerUplink(options, logger); }\n\n  logger.info('Starting uplink', options);\n\n  var uplink = this;\n  var channelName = options.channelName.toString();\n\n  // TODO: Remove clientId when https://github.com/ably/ably-js/issues/252 resolved\n  var client = new Ably.Realtime({ authUrl: '/flyer/' + channelName + '/token', clientId: channelName.toString() });\n  var channel = client.channels.get(channelName);\n\n  /* Flights namespace is configured to persist messages */\n  var flightRecorderChannelName = \"flights:\" + options.channelName;\n  var flightRecorderChannel = client.channels.get(flightRecorderChannelName);\n\n  var broadcastChannelName = Config.broadcastNewChannelName;\n  var broadcastChannel = client.channels.get(broadcastChannelName);\n\n  var deviceType = new Device().deviceDescription();\n\n  var noop = function() {};\n\n  var intervalTransmissionSetup,\n      lastTransmissionTargetTimestamp,\n      lastReading,\n      lastOrientation;\n\n  function startTransmissionTimer() {\n    var timestamp = Date.now(),\n        nextFireDelay\n\n    if (lastTransmissionTargetTimestamp) {\n      lastReading.timestamp = lastTransmissionTargetTimestamp;\n      lastOrientation.timestamp = lastTransmissionTargetTimestamp;\n    }\n\n    if (lastTransmissionTargetTimestamp) {\n      /* Adjust next transmission based on the delay of this transmission */\n      nextFireDelay = lastTransmissionTargetTimestamp - timestamp + Config.readingPublishLimit;\n      lastTransmissionTargetTimestamp = timestamp + nextFireDelay;\n    } else {\n      /* Fire exatly on the interval intended i.e. 0.0, 0.2, 0.4 if 200ms intervals */\n      nextFireDelay = Config.readingPublishLimit - (timestamp % Config.readingPublishLimit);\n      lastTransmissionTargetTimestamp = timestamp + nextFireDelay;\n      setTimeout(startTransmissionTimer, nextFireDelay);\n      return;\n    }\n\n    channel.publish(\"reading\", { reading: lastReading, orientation: lastOrientation }, function(err) {\n      if (err) {\n        logger.warn(\"Unable to send new reading; err = \" + err.message);\n      }\n    });\n\n    setTimeout(startTransmissionTimer, nextFireDelay);\n  }\n\n  function transmitReadingAndOrientation(reading, orientation) {\n    lastReading = reading;\n    lastOrientation = orientation;\n    if (!intervalTransmissionSetup) {\n      startTransmissionTimer();\n      intervalTransmissionSetup = true;\n    }\n  }\n\n  function transmitFlightData(flightData){\n    flightRecorderChannel.publish(\"flight\", flightData, function(err) {\n      if (err) {\n        logger.warn(\"Unable to send new fligth data; err = \" + err.message);\n      }\n    })\n  }\n\n  function broadcastNewChannel() {\n    broadcastChannel.publish(\"new\", { channel: channelName, device: deviceType });\n  }\n\n  client.connection.on(\"connected\", function(err) {\n    uplink.onconnected();\n  });\n\n  client.connection.on(\"disconnected\", function(err) {\n    logger.warn(\"Uplink is disconnected\", err);\n    uplink.onconnectionDisconnected(err);\n  });\n\n  client.connection.on(\"failed\", function(err) {\n    console.error(\"Connection failed\", err);\n    uplink.onconnectionFailed(err);\n  });\n\n  /* Be present on the channel so that subscribers know a publisher is here */\n  channel.presence.enter({ device: deviceType }, function(err) {\n    if (err) {\n      logger.error(\"Could not enter presence\", err);\n      uplink.onconnectionFailed(err);\n    } else {\n      logger.info(\"Present on channel\", channelName, \", device:\", deviceType);\n      broadcastNewChannel();\n    }\n  });\n\n  flightRecorderChannel.attach(function(err) {\n    if (err) {\n      logger.error(\"Could not attach to flight recorder channel\", flightRecorderChannelName);\n    } else {\n      logger.info(\"Attached to flight recorder channel\", flightRecorderChannelName);\n    }\n  });\n\n  /* Register leave events quickly so that Ably knows the client is gone intentionally\n     as opposed to disconnected abruptly */\n  window.onunload = window.onbeforeunload = function () {\n    client.connection.close();\n  };\n\n  this.channelName = channelName;\n\n  /* These callbacks events are specified by the creator of this object */\n  this.onconnected = noop;\n  this.onconnectionFailed = noop;\n  this.onconnectionDisconnected = noop;\n\n  this.transmitReadingAndOrientation = transmitReadingAndOrientation;\n  this.transmitFlightData = transmitFlightData;\n}\n","/* jshint esnext: true */\n\nexport function KeyError(key) {\n  this.name = \"KeyError\";\n  this.message = \"key \\\"\" + key + \"\\\" not found\";\n  this.stack = (new Error()).stack;\n}\nKeyError.prototype = Object.create(Error.prototype);\nKeyError.prototype.constructor = KeyError;\n\nexport default KeyError;\n","/* jshint esnext: true */\n\nimport KeyError from \"./key-error\";\n\nexport function Struct(defaults, source){\n  \"use strict\";\n  if ( !(this instanceof Struct) ) { return new Struct(defaults, source); }\n\n  Object.assign(this, defaults);\n  for (var key in source) {\n    if (source.hasOwnProperty(key)) {\n      if (!this.hasOwnProperty(key)) {\n        throw new KeyError(key);\n      }\n      this[key] = source[key];\n    }\n  }\n  Object.freeze(this);\n}\n\nStruct.prototype.hasKey = function (key) {\n  return Object.keys(this).indexOf(key) !== -1;\n};\n\nStruct.prototype.fetch = function (key) {\n  if (this.hasKey(key)) {\n    return this[key];\n  } else {\n    throw new KeyError(key);\n  }\n};\n\nStruct.prototype.set = function (key, value) {\n  if (this[key] === value) {\n    return this;\n  }\n  var tmp = {};\n  tmp[key] = value;\n  return this.merge(tmp);\n};\n\nStruct.prototype.update = function (key, operation) {\n  return this.set(key, operation(this[key]));\n};\n\nStruct.prototype.merge = function (other) {\n  return Struct(this, other);\n};\n\nexport default Struct;\n","import Struct from \"../../node_modules/carbide/struct\";\n\nvar FLYER_STATE_DEFAULTS = {\n  uplinkStatus: \"CONNECTING\",\n  uplinkDetails: {},\n  latestReading: null, // DEBT best place a null object here\n  currentFlight: [],\n  flightHistory: [],\n  alert: \"\"\n};\n\n// DEBT not quite sure why this can't just be named state;\nexport default function FlyerState(raw){\n  if ( !(this instanceof FlyerState) ) { return new FlyerState(raw); }\n\n  // DEBT with return statement is not an instance of FlyerState.\n  // without return statement does not work at all.\n  return Struct.call(this, FLYER_STATE_DEFAULTS, raw);\n}\n\nFlyerState.prototype = Object.create(Struct.prototype);\nFlyerState.prototype.constructor = FlyerState;\n","/* jshint esnext: true */\n\nfunction readingsDuration(readings){\n  if (!readings[0]) { return 0; }\n\n  var t0 = readings[0].timestamp;\n  var t1 = readings[readings.length - 1].timestamp;\n\n  return (t1 - t0) / 1000;\n}\n\nfunction altitudeForFreefallDuration(durationInSeconds){\n  /*\n    Altitude Calculation\n\n    Makes an assumption that magnitude is 10 (stationery) at\n    the top of the throw and bottom of the throw starts when magnitude\n    starts increasing again indicating deceleration. Our flight data\n    is trimmed before it arrives here so that it only contains freefall\n    information.\n\n    As we have two peaks and one trough, the freefall data is the mid point\n    (as in level of 10) of peak 1 & bottom of trough 1.\n\n    Vertical drop formula:\n      height = gravity 9.8m/s * time^2 / 2\n  */\n\n  return 9.8 * Math.pow(durationInSeconds, 2) / 2;\n}\n\nfunction round(number){\n  return parseFloat(number.toFixed(2));\n}\n\nfunction maxFlightDuration(flights) {\n  var flightDurations = flights.map(readingsDuration);\n  return Math.max.apply(null, flightDurations);\n}\n\nfunction maxAltitude(flights) {\n  var flightDurations = flights.map(readingsDuration);\n  var max = Math.max.apply(null, [0].concat(flightDurations));\n  return round(altitudeForFreefallDuration(max));\n}\n\nfunction Projection(rawState){\n  Object.defineProperty(this, \"maxFlightTime\", {\n    get: function(){\n      return maxFlightDuration(rawState.flightHistory.concat(rawState.currentFlight));\n    }\n  });\n\n  Object.defineProperty(this, \"lastFlightTime\", {\n    get: function(){\n      var lastFlight = rawState.flightHistory[rawState.flightHistory.length - 1];\n      return maxFlightDuration([lastFlight]);\n    }\n  });\n\n  Object.defineProperty(this, \"lastFlightTimestamp\", {\n    get: function(){\n      var lastFlight = rawState.flightHistory[rawState.flightHistory.length - 1];\n      return lastFlight[lastFlight.length-1].timestamp;\n    }\n  });\n\n  Object.defineProperty(this, \"flightCount\", {\n    get: function(){\n      return rawState.flightHistory.length;\n    }\n  });\n\n  Object.defineProperty(this, \"maxAltitude\", {\n    get: function(){\n      return maxAltitude(rawState.flightHistory.concat(rawState.currentFlight));\n    }\n  });\n\n  Object.defineProperty(this, \"lastAltitude\", {\n    get: function(){\n      var lastFlight = rawState.flightHistory[rawState.flightHistory.length - 1];\n      return maxAltitude([lastFlight]);\n    }\n  });\n\n  Object.defineProperty(this, \"latestReading\", {\n    get: function(){\n      return rawState.latestReading;\n    }\n  });\n\n  Object.defineProperty(this, \"hasThrow\", {\n    get: function(){\n      return this.maxAltitude !== 0;\n    }\n  });\n\n  Object.defineProperty(this, \"hasOneThrow\", {\n    get: function(){\n      return this.hasThrow && (rawState.flightHistory.length === 1);\n    }\n  });\n\n  Object.defineProperty(this, \"uplinkStatus\", {\n    get: function(){\n      return rawState.uplinkStatus;\n    }\n  });\n  Object.defineProperty(this, \"channelName\", {\n    get: function(){\n      return rawState.uplinkDetails.channelName;\n    }\n  });\n  Object.defineProperty(this, \"alert\", {\n    get: function(){\n      return rawState.alert;\n    }\n  });\n}\n\nexport function project(app){\n  return new Projection(app);\n}\nexport default project;\n","/* jshint esnext: true */\n\nfunction isRational() {\n  for (var i = 0; i < arguments.length; i++) {\n    var val = arguments[i];\n    if (typeof val !== \"number\"){\n      return false;\n    }\n    if (!isFinite(val)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction roundtoFour(number) {\n  return parseFloat(number.toFixed(4));\n}\n\nexport default function Reading(raw){\n  if ( !(this instanceof Reading) ) { return new Reading(raw); }\n\n  this.x = raw.x;\n  this.y = raw.y;\n  this.z = raw.z;\n  this.timestamp = raw.timestamp;\n\n  if (!isRational(this.x, this.y, this.z, this.timestamp)) {\n    throw new TypeError(\"Reading should have numerical values for x, y, z & timestamp\");\n  }\n}\n\nObject.defineProperty(Reading.prototype, \"magnitude\", {\n  get: function(){\n    return roundtoFour(Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z));\n  }\n});\n\nReading.prototype.asJson = function() {\n  return {\n    timestamp: this.timestamp,\n    magnitude: this.magnitude\n  }\n};\n","export default function Audio() {\n  if ( !(this instanceof Audio) ) { return new Audio(); }\n\n  ion.sound({\n    sounds: [{ name: \"pop_cork\" }],\n    volume: 1,\n    path: \"/images/audio/\",\n    preload: true\n  });\n\n  this.playDropSound = function() {\n    ion.sound.play(\"pop_cork\");\n  }\n}\n","/* jshint esnext: true */\n\nimport Projection from \"./flyer/projection\";\nimport Reading from \"./lib/reading\";\nimport Audio from \"./lib/Audio\";\nimport FlyerState from './flyer/state'\n\nvar Thresholds = {\n  peak: 18,\n  trough: 4,\n  stagnantMovementTime: 1000,\n  stagnantMovementAmount: 7, /* expect at least this much movement in magnitude over stagnantMovementTime */\n  flightPause: 2000, /* period we stop detecting throws after a throw has been made */\n  peakTroughMinTime: 400, /* Min time we expect from the throw peak to the drop trough to consider this a valid throw */\n  crossZeroPointBuffer: 40, /* Ignore some noise when falling / climbing for a few milliseconds that could cause it jump above & below zero point briefly */\n  minFlightTime: 150 /* min flight time to be a viable throw */\n}\n\nvar DebugThrows = false; /* Will output debugging info when false */\nvar lastDebugArgs;\n\nfunction debug() {\n  if (DebugThrows) {\n    var argsString = Array.prototype.join.call(arguments, \",\");\n    if (lastDebugArgs === argsString) {\n      return;\n    }\n    lastDebugArgs = argsString;\n\n    console.debug.apply(console, arguments);\n  }\n}\n\n/* Class that wraps a reading but has logic\n   that allows it to be queried with a nice DSL */\n\nfunction PeakOrTrough(reading) {\n  this.historicalReadings = [];\n  this.updateReading(reading);\n}\n\nPeakOrTrough.prototype.exceedThreshold = function() {\n  return (this.magnitude < Thresholds.trough) ||\n    (this.magnitude > Thresholds.peak);\n};\n\nPeakOrTrough.prototype.isPeak = function() {\n  return this.magnitude > 10;\n}\n\nPeakOrTrough.prototype.type = function() {\n  return this.isPeak() ? 'peak' : 'trough';\n}\n\n/* If we sample the last X seconds of the readings,\n   we expect to see reasonable movement in magnitude in one direction\n   else it's probably no longer in flight */\nPeakOrTrough.prototype.isStagnant = function() {\n  if (this.timestampEnd - this.timestampStart < Thresholds.stagnantMovementTime) {\n    /* This peak or trough cannot be stagnant unless some time has passed first */\n    return false;\n  }\n\n  var magnitudes = this.historicalReadings.filter(function(reading) {\n    reading.timestamp >= Date.now() - Thresholds.stagnantMovementTime;\n  }).map(function(reading) {\n    return reading.magnitude;\n  });\n\n  if (magnitudes.length === 0) {\n    return true;\n  }\n\n  var max = Math.max.apply(null, magnitudes),\n      min = Math.min.apply(null, magnitudes);\n\n  debug(\"isStagnant:\", Math.abs(max - min) < Thresholds.stagnantMovementAmount, min, max);\n\n  return Math.abs(max - min) < Thresholds.stagnantMovementAmount;\n}\n\n/* A trough of 3 is less than a trough  of 2\n   and a peak of 19 is less than a peak of 22 */\nPeakOrTrough.prototype.isLessThan = function(newPeakOrTrough) {\n  if (this.magnitude < 10) {\n    return newPeakOrTrough.magnitude < this.magnitude;\n  } else {\n    return newPeakOrTrough.magnitude > this.magnitude;\n  }\n};\n\nPeakOrTrough.prototype.updateReading = function(reading) {\n  this.reading = reading;\n  this.magnitude = reading.magnitude;\n  if (!this.timestampStart) { this.timestampStart = reading.timestamp; }\n  this.timestampEnd = reading.timestamp;\n  this.historicalReadings.push(reading);\n};\n\n/* If this peak or trough has crossed the zero point (technically 10)\n   i.e. it is now going in the opposite direction */\nPeakOrTrough.prototype.crossedZeroPoint = function() {\n  this.crossedZeroPointTimestamp = Date.now();\n};\n\nPeakOrTrough.prototype.hasRecentlyCossedZeroPoint = function() {\n  return this.crossedZeroPointTimestamp && (this.crossedZeroPointTimestamp < Date.now() - Thresholds.crossZeroPointBuffer);\n};\n\nPeakOrTrough.prototype.asJson = function() {\n  return {\n    magnitude: this.magnitude,\n    readings: this.historicalReadings.map(function(reading) { return [reading.timestamp, reading.magnitude]; }),\n    timestampStart: this.timestampStart,\n    timestampEnd: this.timestampEnd\n  };\n};\n\nexport default function Flyer(state) {\n  if ( !(this instanceof Flyer) ) { return new Flyer(state); }\n\n  var flyer = this;\n  var audio = new Audio();\n  var peakOrTroughHistory = [];\n  var currentFlightReadings = [];\n  var lastThrowCompleted;\n\n  state = FlyerState(state || {});\n  flyer.state = state;\n\n  flyer.uplinkAvailable = function(channelName) {\n    if (flyer.state.uplinkStatus === 'INCOMPATIBLE') { return; }\n\n    flyer.state = flyer.state.merge({\n      \"uplinkStatus\": \"TRANSMITTING\",\n      \"uplinkDetails\": channelName\n    });\n    flyer.logger.info(\"Uplink available, transmission commencing\", channelName);\n    showcase(flyer.state);\n  };\n\n  flyer.uplinkFailed = function(err) {\n    if (flyer.state.uplinkStatus === 'INCOMPATIBLE') { return; }\n\n    flyer.state = flyer.state.set(\"uplinkStatus\", \"FAILED\");\n    showcase(flyer.state);\n    flyer.logger.error(\"Uplink failed\", err);\n  };\n\n  flyer.uplinkDisconnected = function() {\n    if (flyer.state.uplinkStatus === 'INCOMPATIBLE') { return; }\n\n    flyer.state = flyer.state.set(\"uplinkStatus\", \"DISCONNECTED\");\n    showcase(flyer.state);\n    flyer.logger.warn(\"Uplink disconnected, will attempt reconnect\");\n  };\n\n  flyer.newReading = function(raw) {\n    var reading = Reading({\n      x: raw.dm.gx, /* raw.dm is devicemotion */\n      y: raw.dm.gy,\n      z: raw.dm.gz,\n      timestamp: Date.now()\n    });\n\n    var orientation = raw.do;\n    orientation.orientation = window.orientation;\n\n    transmitReadingAndOrientation(reading, orientation);\n\n    flyer.view.renderPhoneMovement(reading);\n    flyer.view.renderPhoneOrientation(orientation);\n\n    this.trackThrows(reading, function(currentFlight, peakOrTroughHistory) {\n      var state = flyer.state.set(\"latestReading\", reading);\n      var flightHistory = state.flightHistory;\n\n      flightHistory.push(currentFlight);\n      flyer.state = state.set({\n        \"currentFlight\": currentFlight,\n        \"flightHistory\": flightHistory\n      });\n\n      showcase(flyer.state);\n\n      audio.playDropSound();\n      transmitFlightData(flyer.state, currentFlight, peakOrTroughHistory);\n    });\n  };\n\n  /****\n\n    Calls the callback with an Array of readings when\n    a throw is detected\n\n    A throw is typically a curve in the form\n        ---      ---\n    ----/   \\    /   \\-----\n            \\__/\n\n    What we need to identify is two large peaks with an\n    opposing peak/trough to work out how long the throw was\n\n    Assumption is that throw is end of the first up curve i.e. it's stopped accelerating upwards,\n    until the bottom of the following down curve when it starts decellerating.\n\n  ****/\n  flyer.trackThrows = function(reading, callback) {\n    var currentPeakOrTrough = new PeakOrTrough(reading);\n    var lastPeakOrTrough = peakOrTroughHistory[peakOrTroughHistory.length - 1];\n    var freefallData;\n\n    /* Prevent detection sometimes on bounce / catch */\n    if (lastThrowCompleted && (lastThrowCompleted > Date.now() - Thresholds.flightPause)) {\n      debug('Ignoring throw data due to previous throw', lastThrowCompleted);\n      return;\n    }\n\n    /* Start recording peaks or troughs, update the extremes of the peaks or\n       troughs, and when peak switches to trough or vice versa, add a new\n       recorded peak or trough in history */\n    if (currentPeakOrTrough.exceedThreshold()) {\n      if (!lastPeakOrTrough) {\n        /* We only start recording from a peak, never from a trough */\n        if (currentPeakOrTrough.isPeak()) {\n          debug('Detected first peak', reading.asJson());\n          peakOrTroughHistory.push(currentPeakOrTrough);\n        } else {\n          debug('Trough so ignoring data', reading.asJson());\n        }\n      } else {\n        if (currentPeakOrTrough.isPeak() === lastPeakOrTrough.isPeak()) {\n          if (lastPeakOrTrough.isLessThan(currentPeakOrTrough)) {\n            debug('In play ' + currentPeakOrTrough.type() + ' is greater than old peak', reading.asJson());\n            lastPeakOrTrough.updateReading(reading);\n          }\n        } else {\n          peakOrTroughHistory.push(currentPeakOrTrough);\n          debug('New ' + currentPeakOrTrough.type() + ' detected. Now', peakOrTroughHistory.length, 'peaks or troughs.', reading.asJson());\n          while (peakOrTroughHistory.length > 3) {\n            debug('Truncating first peak and trough as new peaks and troughs detected');\n            dropFirstPeakAndTrough();\n          }\n        }\n      }\n    } else {\n      if (lastPeakOrTrough) {\n        /* Current movement is up or down from last peak or trough i.e. crossed the 10 position */\n        if (currentPeakOrTrough.isPeak() !== lastPeakOrTrough.isPeak()) {\n          /* Record that the last peak has now crossed the zero point */\n          lastPeakOrTrough.crossedZeroPoint();\n        } else {\n          /* The current position is of the same type as the previous peak/trough yet it has crozzed the zero point\n             and has now come back without crossing a threshold. This is just noise or someone waving it up and down */\n          if (lastPeakOrTrough.hasRecentlyCossedZeroPoint()) {\n            debug('Last peak or trough has recently crossed zero point and has come back the other way now. Discarding everything', currentPeakOrTrough, lastPeakOrTrough, peakOrTroughHistory);\n            /* This is not a valid throw, clear all history */\n            peakOrTroughHistory = [];\n            currentFlightReadings = [];\n            return;\n          }\n        }\n      }\n\n      /* We are no longer exceeding a peak or trough\n         and we have satisfied the requirements of three peaks */\n      if (peakOrTroughHistory.length === 3) {\n        debug('Total 3 peaks or troughs detected and now in middle ground.', reading.asJson());\n\n        var peakToTroughDuration = peakOrTroughHistory[2].timestampEnd - peakOrTroughHistory[0].timestampStart;\n        if (peakToTroughDuration < Thresholds.peakTroughMinTime) {\n          debug('Peak to peak duration too low so skipping that peak & trough', peakToTroughDuration, peakOrTroughHistory);\n          /*\n            The peak and trough are too close togeher, person is probably just waving phone up and down.\n            Lets keep this current peak and drop previous peak & trough\n          */\n          dropFirstPeakAndTrough();\n        } else {\n          lastThrowCompleted = Date.now();\n\n          /* Only keep the flight data for the freefall, see Projection\n             for a better explanation of why we only use freefall data */\n          freefallData = filterFreefallData(currentFlightReadings);\n          debug(\"Free fall data\", freefallData);\n\n          var flightTime = freefallData[freefallData.length - 1].timestamp - freefallData[0].timestamp;\n          if (flightTime < Thresholds.minFlightTime) {\n            debug(\"Flight too short\", flightTime, \"discarding\");\n          } else {\n            callback(freefallData, peakOrTroughHistory);\n          }\n\n          peakOrTroughHistory = [];\n          currentFlightReadings = [];\n          return;\n        }\n      }\n    }\n\n    if (lastPeakOrTrough) {\n      if (lastPeakOrTrough.isStagnant()) {\n        debug('Last peak or trough stagnant. Discarding everything', lastPeakOrTrough, peakOrTroughHistory);\n        /* This is not a valid throw, clear all history */\n        peakOrTroughHistory = [];\n        currentFlightReadings = [];\n      } else {\n        currentFlightReadings.push(reading);\n      }\n    }\n  }\n\n  flyer.closeAlert = function(){\n    // DEBT untested\n    flyer.state = flyer.state.set(\"alert\", \"\");\n    showcase(flyer.state);\n  };\n\n  flyer.accelerometerNotSupported = function() {\n    flyer.state = flyer.state.merge({\n      \"alert\": \"Accelerometer not found for this device. Please try again on a different mobile\",\n      \"uplinkStatus\": \"INCOMPATIBLE\"\n    });\n    showcase(flyer.state);\n  }\n\n  function dropFirstPeakAndTrough() {\n    peakOrTroughHistory.splice(0,2);\n    currentFlightReadings = currentFlightReadings.filter(function(reading) {\n      return reading.timestamp >= peakOrTroughHistory[0].timestamp;\n    });\n  }\n\n  function filterFreefallData(flightData) {\n    var freefallData = [],\n        reading,\n        lowestMagnitude,\n        inFreefall;\n\n    /* First get all data that is below stationery i.e. in freefall\n       but only keep the points that are increasingly lower in magnitude.\n       See Projection for more details on assumptions */\n    for (var i = 0; i < flightData.length; i++) {\n      reading = flightData[i];\n      if (reading.magnitude >= 10) { continue; }\n\n      if (!lowestMagnitude || (reading.magnitude < lowestMagnitude)) {\n        lowestMagnitude = reading.magnitude;\n        freefallData.push(reading);\n      }\n\n      if (lowestMagnitude < Thresholds.trough) {\n        inFreefall = true;\n      } else if (inFreefall && (reading.magnitude > Thresholds.trough)) {\n        /* This throw is over */\n        return freefallData;\n      }\n    }\n\n    return freefallData;\n  }\n\n  function transmitReadingAndOrientation(reading, orientation) {\n    if (flyer.state.uplinkStatus === \"TRANSMITTING\") {\n      flyer.uplink.transmitReadingAndOrientation(reading, orientation);\n    }\n  }\n\n  function transmitFlightData(state, flightData, peakOrTroughHistory) {\n    if (flyer.state.uplinkStatus === \"TRANSMITTING\") {\n      var projection = Projection(state);\n      var data = {\n        timestamp: projection.lastFlightTimestamp,\n        flightTime: projection.lastFlightTime,\n        altitude: projection.lastAltitude,\n        flightSerialThisSession: projection.flightCount,\n        peakInfo: peakOrTroughHistory.map(function(peak) { return peak.asJson(); })\n      };\n      flyer.uplink.transmitFlightData(data);\n    }\n  }\n\n  function showcase(state){\n    flyer.view.render(Projection(state));\n  }\n\n  // DEBT should be set separatly for Testing\n  flyer.clock = window.Date;\n}\nFlyer.State = FlyerState;\n","/* jshint esnext: true */\n\nexport function format(i){\n  var fixed = i.toFixed(2);\n  var signed = i < 0 ? fixed : \"+\" + fixed;\n  var short = \"+00.00\".length - signed.length;\n  var padded = (short == 1) ? signed.replace(/[\\+\\-]/, function(sign){ return sign + \"0\"; }) : signed;\n  return padded;\n}\n\nfunction Presenter(projection){\n\n  Object.defineProperty(this, \"maxFlightTime\", {\n    get: function(){\n      return projection.maxFlightTime + \"s\";\n    }\n  });\n\n  Object.defineProperty(this, \"rawMaxFlightTime\", {\n    get: function(){\n      return projection.maxFlightTime;\n    }\n  });\n\n  Object.defineProperty(this, \"lastFlightTime\", {\n    get: function(){\n      return projection.lastFlightTime + \"s\";\n    }\n  });\n\n  Object.defineProperty(this, \"maxAltitude\", {\n    get: function(){\n      return projection.maxAltitude + \"m\";\n    }\n  });\n\n  Object.defineProperty(this, \"rawMaxAltitude\", {\n    get: function(){\n      return projection.maxAltitude;\n    }\n  });\n\n  Object.defineProperty(this, \"lastAltitude\", {\n    get: function(){\n      return projection.lastAltitude + \"m\";\n    }\n  });\n\n  Object.defineProperty(this, \"hasThrow\", {\n    get: function(){\n      return projection.hasThrow;\n    }\n  });\n\n  Object.defineProperty(this, \"hasOneThrow\", {\n    get: function(){\n      return projection.hasOneThrow;\n    }\n  });\n\n  Object.defineProperty(this, \"lastHigherThanBefore\", {\n    get: function(){\n      return projection.lastAltitude == projection.maxAltitude;\n    }\n  });\n\n  Object.defineProperty(this, \"uplinkStatus\", {\n    get: function(){\n      return projection.uplinkStatus.toLowerCase();\n    }\n  });\n\n  Object.defineProperty(this, \"channelName\", {\n    get: function(){\n      return projection.channelName;\n    }\n  });\n}\n\nexport function present(app){\n  return new Presenter(app);\n}\nexport default present;\n","/* jshint esnext: true */\n\nexport default function Display() {\n  var $root = $('.notices'),\n      $message = $root.find('.message');\n\n  return Object.create({}, {\n    active: {\n      set: function(active){\n        var ACTIVE = \"active\";\n        if (active) {\n          $root.addClass(ACTIVE);\n        } else {\n          $root.removeClass(ACTIVE);\n        }\n      },\n      enumerable: true\n    },\n    message: {\n      set: function(message){\n        $message.html(message);\n      }\n    }\n  });\n}\n","/* jshint esnext: true */\n\nimport AlertDisplay from \"../../alert/display\";\nimport Device from \"../../lib/device\";\n\n/* This function class contains the logic for the presentation\n   messaging in the view based on the state, but is weirdly not a\n   view itself as their is a view, a projection, and a presenter? */\n\nfunction Display($root){\n  var $leaderboardPanel = $root.find(\".leaderboard\"),\n      $leaderboardSubmitPanel = $leaderboardPanel.find(\".submit-panel\"),\n      $leaderboardSubmittedPanel = $leaderboardPanel.find(\".submitted-panel\"),\n      $leaderboardForm = $leaderboardPanel.find(\"form\"),\n      $leaderBoardFormNickname = $leaderboardPanel.find(\"form input[name=nickname]\"),\n      $leaderBoardFormAltitude = $leaderboardPanel.find(\"form input[name=max-altitude]\"),\n      $leaderBoardFormFlightTime = $leaderboardPanel.find(\"form input[name=max-flight-time]\"),\n      $leaderBoardAltitudeMessage = $leaderboardPanel.find(\".max-altitude-message\"),\n      $leaderBoardSubmittedAltitude = $leaderboardPanel.find(\".max-altitude-message-submitted\");\n\n  var $message = $root.find(\".message\"),\n      $uplinkStatus = $root.find(\".uplink-status\"),\n      $loader = $root.find(\".connecting-loader\"),\n      $connectionActive = $root.find(\".connection-active\");\n\n  var alertDisplay = AlertDisplay();\n\n  var deviceType = new Device().deviceDescription();\n\n  function init() {\n    $leaderboardForm.on('submit', function(event) {\n      event.preventDefault();\n\n      var altitude = $leaderBoardFormAltitude.val(),\n          flightTime = $leaderBoardFormFlightTime.val(),\n          nickname = $leaderBoardFormNickname.val().replace(/^\\s+|\\s+$/g,\"\"),\n          data = {\n            \"max-altitude\": altitude,\n            \"max-flight-time\": flightTime,\n            \"nickname\": nickname,\n            \"device\": deviceType\n          };\n\n      if (nickname.length === 0) {\n        alert(\"Sorry, you need to have a nickname to enter the leaderboard\");\n        $leaderBoardFormNickname.focus();\n        return;\n      }\n\n      if (window.localStorage) {\n        localStorage.setItem('nickname', nickname);\n      }\n\n      $leaderboardForm.find('submit').attr('disabled', 'disabled');\n\n      $.post('/submit-flight', data).done(function() {\n          alertDisplay.active = false;\n          $leaderBoardSubmittedAltitude.text(altitude + \"m\");\n          $leaderboardSubmitPanel.hide();\n          $leaderboardSubmittedPanel.show();\n        }).fail(function() {\n          alertDisplay.message = \"Oops, something went wrong submitting your lob to the leaderboard. Please try again\";\n          alertDisplay.active = true;\n        }).always(function() {\n          $leaderboardForm.find('submit').removeAttr('disabled');\n        })\n    });\n  }\n\n  function setLoading(isLoading) {\n    if (isLoading) {\n      $loader.show();\n      $connectionActive.hide();\n    } else {\n      $loader.hide();\n      $connectionActive.show();\n    }\n  }\n\n  function showLeaderboard(altitude, flightTime) {\n    $leaderboardPanel.show();\n    $leaderboardSubmitPanel.show();\n    $leaderboardSubmittedPanel.hide();\n    $leaderBoardFormAltitude.val(altitude);\n    $leaderBoardFormFlightTime.val(flightTime);\n    $leaderBoardAltitudeMessage.text(Math.round(altitude * 100)/100 + \"m\");\n\n    if (window.localStorage && window.localStorage.getItem('nickname')) {\n      $leaderBoardFormNickname.val(window.localStorage.getItem('nickname'));\n    }\n  }\n\n  function updateUplinkStatus(presentation) {\n    switch(presentation.uplinkStatus.toLowerCase()) {\n      case \"connecting\":\n        $uplinkStatus.html(\"Hold on, we're establishing a realtime connection to stream your lob.\");\n        setLoading(true);\n        break;\n      case \"disconnected\":\n        $uplinkStatus.html(\"Hold on, we've lost the realtime connection. Trying to reconnect now.\");\n        setLoading(true);\n        break;\n      case \"failed\":\n        $uplinkStatus.html(\"Oops, we've failed to establish a realtime connection. Try reloading this app.\");\n        setLoading(true);\n        break;\n      case \"incompatible\":\n        $uplinkStatus.html(\"Unfortunately no accelerometer was found on this device. Please try again on a different mobile\");\n        setLoading(true);\n        break;\n      case \"transmitting\":\n        $uplinkStatus.html(\"<p class='title-with-hint'>Your unique Lob code is: <b>\" + presentation.channelName + \"</b></p>\" +\n          \"<p class='hint'>Give this to others and they can watch your Lob live.<br><a href='/why-stream'>How does this work?</a>\");\n        setLoading(false);\n        break;\n      default:\n        console.error('Unknown status', status);\n    }\n  }\n\n  function renderNoThrows(presentation) {\n    $message.html(\"<p>Are you ready?</p><p><b>Lob your phone in the air now.</b></p><p>Good luck!</p>\");\n    updateUplinkStatus(presentation);\n  }\n\n  function renderFirstThrow(presentation) {\n    $message.html(\"<p>Great throw!</p>\" +\n      \"<p>You lobbed it <b>\" + presentation.lastAltitude + \"</b> for <b>\" + presentation.lastFlightTime + \"</b></p>\" +\n      \"<p>Go on, try again!</p>\");\n    updateUplinkStatus(presentation);\n  }\n\n  function renderMultipleThrows(presentation) {\n    if (presentation.lastHigherThanBefore) {\n      $message.html(\"<p>Superb, <b>that's your new record!</b></p>\" +\n        \"<p>You lobbed it <b>\" + presentation.lastAltitude + \"</b> for <b>\" + presentation.lastFlightTime + \"</b></p>\" +\n        \"<p>Your previous best was <b>\" + presentation.maxAltitude + \"</b> high</p>\" +\n        \"<p>Go for glory, see if you can go higher!</p>\");\n      showLeaderboard(presentation.rawMaxAltitude, presentation.rawMaxFlightTime);\n    } else {\n      $message.html(\"<p>Not bad, but that's not your best so far.</p>\" +\n        \"<p>You lobbed it <b>\" + presentation.lastAltitude + \"</b> for <b>\" + presentation.lastFlightTime + \"</b></p>\" +\n        \"<p>Your previous best was <b>\" + presentation.maxAltitude + \"</b> high</p>\" +\n        \"<p>Give it another go!</p>\");\n    }\n    updateUplinkStatus(presentation);\n  }\n\n  this.render = function(presentation) {\n    if (!presentation.hasThrow) {\n      renderNoThrows(presentation);\n    } else if (presentation.hasOneThrow) {\n      renderFirstThrow(presentation);\n      showLeaderboard(presentation.rawMaxAltitude, presentation.rawMaxFlightTime);\n    } else {\n      renderMultipleThrows(presentation);\n    }\n  }\n\n  init();\n}\n\nexport function create($root){ Display($root); }\n\nexport default Display;\n","export default function Phone() {\n  if ( !(this instanceof Phone) ) { return new Phone(); }\n  var $phone = document.documentElement.querySelector('#tridiv .scene');\n  var prefixes = [\"-webkit-\", \"-moz-\", \"-ms-\", \"\"];\n\n  this.setOrientation = function(position) {\n    var landscape = false;\n\n    if ((position.orientation == 90) || (position.orientation == -90)) {\n      landscape = true;\n    }\n\n    /* Don't rotate on Y axis so that phone rotates on X & Y axis in front of user */\n    var xRotation = (90 - position.beta) + 270,\n        yRotation = landscape ? 90 : 0,\n        zRotation = position.gamma;\n\n    var cssText = '';\n\n    for (var prefixIndex = 0; prefixIndex < prefixes.length; prefixIndex++) {\n      var prefix = prefixes[prefixIndex];\n      cssText += prefix + 'transform: rotateX(' + xRotation + 'deg) rotateY(' + yRotation + 'deg) rotateZ(' + zRotation + 'deg);';\n    }\n\n    $phone.style.cssText = cssText;\n  }\n}\n","import Reading from \"./reading\";\nimport { Config } from \"../config\";\n\nexport default function Guage() {\n  if ( !(this instanceof Guage) ) { return new Guage(); }\n  var $guage = document.documentElement.querySelector('.guage-widget .needle');\n  var prefixes = [\"-webkit-\", \"-moz-\", \"-ms-\", \"\"];\n\n  this.setMomentum = function(reading) {\n    /* momentum is stationery at 10, less than or greater than represents momentum */\n    var normalizedReading = Math.abs(reading.magnitude - Config.gravityMagnitudeConstant);\n    var boundedReading = Math.min(100, Math.max(0, normalizedReading));\n    var angle = (boundedReading - 50) / 100 * 180;\n    var cssText = '';\n\n    for (var prefixIndex = 0; prefixIndex < prefixes.length; prefixIndex++) {\n      var prefix = prefixes[prefixIndex];\n      cssText += prefix + 'transform: translateX(-50%) translateY(-50%) rotate(' + angle + 'deg);'\n    }\n\n    $guage.style.cssText = cssText;\n  }\n}\n","/* jshint esnext: true */\n\nexport function argsToArray(args){\n  return Array.prototype.slice.call(args);\n}\n\nexport function throttle(fn, threshhold, scope) {\n  threshhold = threshhold;\n  var last,\n  deferTimer;\n  return function () {\n    var context = scope || this;\n    var now = Date.now(), args = arguments;\n\n    if (last && now < last + threshhold) {\n      // hold on to it\n      clearTimeout(deferTimer);\n      deferTimer = setTimeout(function () {\n        last = now;\n        fn.apply(context, args);\n      }, threshhold);\n    } else {\n      last = now;\n      fn.apply(context, args);\n    }\n  };\n}\n","import Presenter from \"./view/presenter\";\nimport Display from \"./view/display\";\nimport AlertDisplay from \"../alert/display\";\nimport Phone from \"../lib/phone\";\nimport Guage from \"../lib/guage\";\n\nimport { Config } from '../config';\nimport { throttle } from \"../utils/fn\";\n\nexport default function FlyerView() {\n  var memoized = {};\n\n  var getDisplay = function() {\n    if (!memoized.display) {\n      var $flyer = $('.flyer');\n      memoized.display = new Display($flyer);\n    }\n    return memoized.display;\n  }\n\n  var getAlertDisplay = function() {\n    if (!memoized.alertDisplay) {\n      memoized.alertDisplay = AlertDisplay();\n    }\n    return memoized.alertDisplay;\n  }\n\n  var getPhone = function() {\n    if (!memoized.phone) {\n      memoized.phone = new Phone();\n    }\n    return memoized.phone;\n  }\n\n  var getGuage = function() {\n    if (!memoized.guage) {\n      memoized.guage = new Guage();\n    }\n    return memoized.guage;\n  }\n\n  var renderPhoneMovement = function(reading) {\n    getGuage().setMomentum(reading);\n  }\n\n  var renderPhoneOrientation = function(position) {\n    getPhone().setOrientation(position);\n  }\n\n  this.render = function(projection) {\n    var presentation = Presenter(projection);\n    var display = getDisplay();\n    var alertDisplay = getAlertDisplay();\n\n    display.render(presentation);\n\n    var alertMessage = projection.alert;\n    if (alertMessage) {\n      alertDisplay.message = alertMessage;\n      alertDisplay.active = true;\n    } else {\n      alertDisplay.active = false;\n    }\n  }\n\n  this.renderPhoneMovement = throttle(renderPhoneMovement.bind(this), Config.readingPublishLimit);\n  this.renderPhoneOrientation = throttle(renderPhoneOrientation.bind(this), Config.readingPublishLimit);\n}\n","if (!Object.assign) {\n  Object.defineProperty(Object, 'assign', {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function(target) {\n      'use strict';\n      if (target === undefined || target === null) {\n        throw new TypeError('Cannot convert first argument to object');\n      }\n\n      var to = Object(target);\n      for (var i = 1; i < arguments.length; i++) {\n        var nextSource = arguments[i];\n        if (nextSource === undefined || nextSource === null) {\n          continue;\n        }\n        nextSource = Object(nextSource);\n\n        var keysArray = Object.keys(nextSource);\n        for (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\n          var nextKey = keysArray[nextIndex];\n          var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);\n          if (desc !== undefined && desc.enumerable) {\n            to[nextKey] = nextSource[nextKey];\n          }\n        }\n      }\n      return to;\n    }\n  });\n}\n","/* jshint esnext: true */\nimport \"./utils/polyfill\";\nimport Flyer from \"./flyer\";\nimport Router from \"./router\";\nimport FlyerView from \"./flyer/view\";\nimport FlyerUplink from './flyer/uplink';\n\nvar router = Router(window.location);\n\nvar uplink = FlyerUplink({\n  channelName: router.state.channelName\n}, window.console);\n\nvar flyer = Flyer();\n\nflyer.logger = window.console;\nflyer.view = new FlyerView\nflyer.uplink = uplink;\n\nfunction AccelerometerController(global, flyer){\n  var gn = new GyroNorm();\n  var logger = function(data) {\n    console.warn(\"Gyro log:\", data);\n  }\n  gn.init({ frequency: 10, decimalCounts: 3, logger: logger }).then(function() {\n    gn.start(function(data) {\n      flyer.newReading(data);\n    });\n  }).catch(function(e) {\n    /* DeviceOrientation or DeviceMotion is not supported by the browser or device */\n    flyer.accelerometerNotSupported();\n  });\n}\n\nvar accelerometerController = new AccelerometerController(window, flyer);\n\nfunction UplinkController(uplink, application){\n  uplink.onconnected = function(){\n    application.uplinkAvailable({ channelName: uplink.channelName });\n  }\n  uplink.onconnectionFailed = function(){\n    application.uplinkFailed();\n  }\n  uplink.onconnectionDisconnected = function(){\n    application.uplinkDisconnected({ channelName: uplink.channelName });\n  }\n}\nvar uplinkController = new UplinkController(uplink, flyer);\nexport default flyer;\n"],"names":["Projection","Display","AlertDisplay","Presenter"],"mappings":"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"}